<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Authorize</title>
  <link rel="stylesheet" href="https://p.trellocdn.com/power-up.min.css">
</head>
<body >

<div id="authorize" style="padding: 20px">
  <h2>Why do I have to authorize&nbsp;my Trello account?</h2>

  <p>This Power-up needs your Trello&#39;s access token to sync the cards</p>
  <button type="button" class="mod-primary" style="width: 100%">Click to Authorize</button>
</div>

<script src="https://p.trellocdn.com/power-up.min.js"></script>
<script src="./api.js"></script>
<script>
  var t = window.TrelloPowerUp.iframe(appInfo);
  t.render(function() {

    setTimeout(() => {
      t.sizeTo('#authorize').done();
    });

    document.querySelector('button').addEventListener('click', function() {
      t.getRestApi()
        .authorize({ scope: 'read,write' })
        .then(function(result) {
          t.alert({
            message: 'Logged in successfully ðŸŽ‰',
            duration: 6,
            display: 'success'
          });
          t.closePopup();
          t.closeModal();
        });
    }, false);
  });
</script>
</body>
</html>
